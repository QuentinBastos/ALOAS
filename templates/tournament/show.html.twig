{% extends 'base.html.twig' %}

{% block title %}Tournoi - {{ tournament.name }}{% endblock %}

{% block body %}
    {% include 'partial/header.html.twig' %}
    {% include 'partial/rightAside.html.twig' %}
    <div class="flex w-screen h-[91vh] ">
        <aside id="sidebar" class="flex w-1/6 min-w-24">
            {% include 'partial/aside.html.twig' %}
        </aside>
        <div class=" w-5/6 container mx-auto flex flex-col items-center pt-6 text-xl font-medium overflow-y-scroll main-content">
            <h1 class="text-2xl font-bold text-[--bg-green-light]">{{ tournament.name }}</h1>
            <p class="text-gray-700 mt-2">üìç Lieu : {{ tournament.location }}</p>
            <p class="text-gray-700">üèÖ Sport : {{ tournament.sport.name }}</p>
            <p class="text-gray-700">üìÖ Date : {{ tournament.date|date('d/m/Y') }}</p>

            <a href="{{ path('app_tournament_list') }}" class="mt-4 inline-block text-[--bg-green-light]">‚¨Ö Retour √† la liste</a>
        </div>
        <h2 class="text-xl font-bold mt-6">üèÜ √âquipes participantes</h2>
        <ul class="mt-2 list-disc list-inside">
            {% for team in teams %}
                <li class="text-gray-800">{{ team.name }}</li>
            {% else %}
                <li class="text-gray-500">Aucune √©quipe inscrite.</li>
            {% endfor %}
        </ul>

        <a href="{{ path('app_team_add', {'tournamentId': tournament.id}) }}" class="mt-4 inline-block text-blue-600">‚ûï Ajouter une √©quipe</a>

        <h2 class="text-xl font-bold mt-6">‚öΩ Matchs</h2>

        {% if matches is empty %}
            <p class="text-gray-500">Aucun match g√©n√©r√© pour l'instant.</p>
        {% else %}
            <table class="mt-2 border-collapse w-full">
                <thead>
                <tr class="bg-gray-200">
                    <th class="border px-4 py-2">Phase</th>
                    <th class="border px-4 py-2">√âquipe √† domicile</th>
                    <th class="border px-4 py-2">√âquipe visiteuse</th>
                    <th class="border px-4 py-2">Score</th>
                </tr>
                </thead>
                <tbody>
                {% for match in matches %}
                    <tr class="border">
                        <td class="border px-4 py-2">Phase {{ match.phase }}</td>
                        <td class="border px-4 py-2">{{ match.home.name }}</td>
                        <td class="border px-4 py-2">{{ match.visitor.name }}</td>
                        <td class="border px-4 py-2">
                            {% if match.homeScore is not null and match.visitorScore is not null %}
                                {{ match.homeScore }} - {{ match.visitorScore }}
                            {% else %}
                                En attente
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% endif %}


        <h2 class="text-xl font-bold mt-6">üèÜ Matchs en cours</h2>

        <form action="{{ path('app_tournament_update_scores', {'id': tournament.id}) }}" method="POST">
            <ul class="mt-2 list-disc list-inside">
                {% for match in tournament.teamMatchResults %}
                    <li class="text-gray-800">
                        {{ match.home.name }}
                        <input type="number" name="home_score_{{ match.id }}" value="{{ match.homeScore ?? '' }}" class="w-12 text-center border border-gray-300 rounded">
                        -
                        <input type="number" name="visitor_score_{{ match.id }}" value="{{ match.visitorScore ?? '' }}" class="w-12 text-center border border-gray-300 rounded">
                        {{ match.visitor.name }}
                    </li>
                {% else %}
                    <li class="text-gray-500">Aucun match en cours.</li>
                {% endfor %}
            </ul>

            <button type="submit" class="mt-4 px-4 py-2 bg-green-500 text-white rounded">Valider les scores</button>
        </form>
    </div>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
{% endblock %}

{% block javascripts %}
    {{ encore_entry_script_tags('app') }}
{% endblock %}
